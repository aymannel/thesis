\section{Higher Order Controlled-Rotations}

We can implement higher order controlled rotations by nesting singly-controlled rotations in CNOT gates as in Yordanov \textit{et al} \cite{Yordanov2020}. We implement a doubly-controlled $Z$ rotation using two singly-controlled $Z$ rotations with opposite phases.

\includezxdiagram{chapter-4/CCRZ1}{0.65}

We can minimise circuit depth when finding a specific implementation of the CCR$_Z$ gate by carefully choosing the specific circuit decomposition of the CR$_Z$ gates, as in the figure on the left, then using the fact that the CNOT gate is self-inverse to cancel the $\text{CNOT}_{1, 2}$ gates highlighted in the figure on the right \cite{Yordanov2020}.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-4/CCRZ2}{1}
    \caption{CR$_Z$ circuit decomposition (left). Cancelling CNOT gates (right).}
\end{figure}

For the purposes of this thesis, we are interested in the form of controlled rotations in terms of phase gadgets. By commuting the CNOT gates in the circuit above and cancelling the relevant CNOT gates, we obtain the following phase polynomial.

\includezxdiagram{chapter-4/CCRZ3}{0.9}

In Chapter \ref{excitation-operators}, we will use this result to show that excitation operators used to construct UCC ans√§tze can be expressed in terms of controlled rotations. Using the phase gadget commutation rule (\ref{phase-gadget-commutation}), we can order the phase gadgets in the phase polynomial as we see fit.

We can build controlled rotations to arbitrary arity by recursively applying the method of nesting controled rotations described above. Hence, as with the doubly-controlled rotation, we can express a triply-controlled rotation by nesting two doubly-controlled rotations as follows.

\includezxdiagram{chapter-4/CCCRZ}{1}

Using the same rules as before, we can show that a triply-controlled rotation corresponds to the following phase polynomial of commuting phase gadgets.
\includezxdiagram{chapter-4/CCCRZ_zx}{0.8}

