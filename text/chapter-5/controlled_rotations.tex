\section{Excitations as Controlled Rotations}%
\label{operator-controlled-rotations}

In this chapter, we replicate the results of Yordanov and Kornell in the ZX calculus using the representation of higher-order controlled rotations developed in Chapter \ref{controlled-rotations}, as well as the commutation relations derived in Chapter \ref{clifford-commutation-relations}.

We began this research with the goal of identifying a generalised structure for the excitation operators used in the DISCO-VQE algorithm, in the ZX calculus. This led us to the work done by Yordanov \textit{et al} \cite{Yordanov2020} and Kornell \textit{et al} \cite{Kornell2023}, which demonstrate that it is possible to reveal an underlying controlled rotation within each excitation operator by conjugating it with some subcircuit.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-5/controlled_rotation}{0.75}
    \caption{Conjugating $U(\theta)$ by subcircuit $S$ to reveal a controlled rotation CR$(\theta)$.}
\end{figure}

One-body and two-body excitation operators have large circuit depths as a result of the multiple CNOT ladder constructions used to compute the parity of the fermionic state. Yordanov \textit{et al} suggest that by rewriting the excitation operators in terms of controlled rotations, we can significantly reduce the circuit depth. We begin by demonstrating this result using a minimal one-body excitation operator, implemented by the following quantum circuit.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-5/minimal}{0.9}
    \caption{Quantum circuit (left) and in Pauli gadget form (right).}
    \label{minimal-one-body}
\end{figure}

By inserting two adjacent (self-inverse) $\text{CNOT}_{0, 1}$ gates into the circuit and using the CNOT commutation relations (\ref{cnot-commutations}) derived in Chapter \ref{pauli-gadgets}, we can show that the one-body excitation operator above corresponds to a singly-controlled $Y$ rotation.

\includezxdiagram{chapter-5/minimal_proof}{1}

Had we instead chosen to insert two $\text{CNOT}_{1, 0}$ gates, we would have obtained the following controlled rotation, with the first qubit being the control.

\includezxdiagram{chapter-5/minimal2}{0.57}

Let us now look at the general one-body excitation operator. We begin by conjugating with CNOT gates and a CZ gate (\ref{cz-definition}) using the CNOT commutation relations (\ref{cnot-commutations}) and CZ commutation relations (\ref{cz-commutations}) derived in Section \ref{clifford-commutation-relations}.

\includezxdiagram{chapter-5/one_body_general_proof1}{1}

Then, by fusing the single-qubit $Y$ rotation with the adjacent Pauli gadget, we reveal a singly-controlled $Y$ rotation, as discussed in Chapter \ref{controlled-rotations}. In this way, we have succesfully replicated the result in Yordanov \textit{et al} \cite{Yordanov2020} using the ZX calculus.

\includezxdiagram{chapter-5/one_body_general_proof2}{1}

Let us now consider the two-body excitation operator, represented as follows.

\includezxdiagram{chapter-5/two_body_proof1}{1}

We begin by conjugating the circuit with three CNOT gates using the CNOT commutation relations (\ref{cnot-commutations}) derived in Section \ref{clifford-commutation-relations}.

\includezxdiagram{chapter-5/two_body_proof2}{0.9}

Then, by cancelling the adjacent Clifford gates, we reveal a phase polynomial.

\includezxdiagram{chapter-5/two_body_proof3}{1}

Finally, by conjugating the circuit with Pauli $X$ gates on the second and fourth qubits, using the Pauli $X$ commutation relations (\ref{pauli-commutations}), we flip the phases of some of the phase gadgets, ensuring that the phase polynomial matches the result for the triply-controlled $Y$ rotation in Figure \ref{cccry}. Note that the \textit{first qubit} corresponds to the target, and the \textit{second, third and fourth qubits}, correspond to the controls.

\includezxdiagram{chapter-5/two_body_proof4}{1}

The target qubit is conjugated by Cliffords, putting it in the $Y$ basis, and since the controls on the second and fourth qubits are conjugated by Pauli $X$ gates, they must be in the $\ket 0$ (rather than $\ket 1$) state, to activate the rotation. We have, therefore, succesfully replicated the result in Yordanov \textit{et al} \cite{Yordanov2020} using the ZX calculus.

At the expense of introducing additional quantum gates, we have eliminated the resource-intensive CNOT ladder constructions associated with the two subcircuits in the one-body excitation operator and the eight subcircuits in the two-body excitation operator. By choosing efficient implementations of controlled $Y$ rotations, we can then offset the gate overhead introduced by the additional quantum gates.

Similarly, Kornell \textit{et al} \cite{Kornell2023} show that by conjugating the two-body excitation operator with the following subcircuit, we obtain the same triply-controlled $Y$ rotation. We were able to demonstrate this in the ZX calculus as follows.

\includezxdiagram{chapter-5/selinger1}{1}

In Chapter \ref{zxfermion}, we introduce a software package called ZxFermion that we developed to facilitate this type of derivation. Using ZxFermion, we were able to identify that it is possible to choose the control and target qubits of the triply-controlled rotation by conjugating with the following subcircuits.

\includezxdiagram{chapter-5/selinger2}{1}

\includezxdiagram{chapter-5/selinger3}{1}

\includezxdiagram{chapter-5/selinger4}{1}
