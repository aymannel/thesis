\section{Implementing Excitation Operators}

In Section \ref{ups-ansatz}, we showed that a fermionic state can be represented by a finite sequence of $k$ parametrised one-body and two-body excitation operators acting on a single-Slater determinant reference state. After invoking the Trotter formula using one time step, we obtained the following equation for the UPS ansatz.

\begin{figure}[H]
    \centering
    \begin{equation*}
        U(\bm\theta) = \prod_{m=1}^k U_m(\theta_m) \qquad
        U_m(\theta_m) = e^{\theta_m (\tau_m - \tau_m^\dagger)}
    \end{equation*}
    \caption{UPS ansatz (sequence of $k$ one-body and two-body excitation operators).}
\end{figure}

In order to implement the fermionic excitation operators $U_m(\theta_m)$ on a quantum computer, we must first represent the second-quantised creation and annhilation operators in terms of quantum gates. For a single-state system, we do this by taking the following linear combinations of the Pauli gates.

\begin{figure}[H]
    \centering
    \begin{equation*}
        \hat a^\dagger = \ket 1 \bra 0 = \frac{1}{2} (X - iY) \qquad\qquad
        \hat a = \ket 0 \bra 1 = \frac{1}{2} (X + iY) 
    \end{equation*}
    \caption{Jordan-Wigner transformation for a single-state system.}
\end{figure}

Recalling that the creation and annhilation operators must preserve the fermionic anti-symmetry imposed by the Pauli principle, we modify these equations to account for the parity of the spin orbitals preceding the target spin orbital $j$ when dealing with many-state systems. We do this by introducing a string of Pauli $Z$ operators to compute the parity of the spin orbitals preceding spin orbital $j$.

\begin{figure}[H]
    \centering
    \begin{equation*}
        \hat a_j^+ = \frac{1}{2} (X - iY) \bigotimes_{k=1}^{j-1} Z_k \qquad\quad
        \hat a_j = \frac{1}{2} (X + iY) \bigotimes_{k=1}^{j-1} Z_k
    \end{equation*}
    \caption{Jordan-Wigner transformation for a many-state system.}
\end{figure}

This mapping is known as the Jordan-Wigner transformation \cite{Seeley2020} and has the advantage of preserving a direct mapping between fermionic states in the occupation number representation and the qubit state vector. In other words, each qubit in our quantum circuit now encodes the occupation number of each spin orbital in our fermionic state $\ket{f_{n-1} \dots f_{0}} \,\,\rightarrow\,\, \ket{q_{n-1} \dots q_{0}}$.

Let us take the unitary operator $U^q_p(\theta)$ to be a one-body excitation operator derived from the anti-Hermitian second-quantised operator $a_q^\dagger a_p - a_p^\dagger a_q$ and acting on qubits $p$ and $q$. After applying the Jordan-Wigner transformation to the second-quantised operator and exponentiating it, we obtain the following one-body excitation operator in terms of the Pauli matrices.

\begin{figure}[H]
    \centering
    \begin{equation*}
        U^q_p (\theta) =
        \text{exp} \left( i
        \frac{\theta}{2} (Y_p X_q - X_p Y_q) \prod_{k=p+1}^{q-1} Z_k \right)
    \end{equation*}
    \caption{One-body excitaiton operator expressed in terms of the Pauli matrices.}
    \label{one-body-excitation-operator}
\end{figure}

By applying the Jordan-Wigner transformation to the two-body excitation operator $U^{rs}_{pq}(\theta)$, derived from the second-quantised operator $a_r^\dagger a_s^\dagger a_q a_p - a_p^\dagger a_q^\dagger a_s a_r$, we obtain the following two-body excitation operator in terms of the Pauli matrices.

\begin{figure}[H]
    \centering
    \begin{align*}
        U^{rs}_{pq} (\theta) &= \text{exp} \left( i \frac{\theta}{8} (
        X_p X_q Y_s X_r +
        Y_p X_q Y_s Y_r +
        X_p Y_q Y_s Y_r +
        X_p X_q X_s Y_r - \right. \\
        &\left. \hspace{1cm} 
        Y_p X_q X_s X_r -
        X_p Y_q X_s X_r -
        Y_p Y_q Y_s X_r -
        Y_p Y_q X_s Y_r )
        \prod_{k=p+1}^{q-1} Z_k
        \prod_{l=r+1}^{s-1} Z_l
        \right)
    \end{align*}
    \caption{Two-body excitation operator expressed in terms of the Pauli matrices.}
\end{figure}

Now that we have expressed the one-body and two-body excitation operators in terms of quantum gates, we discuss their specific implementations on a quantum computer. Starting with the one-body excitation operator, we can show that it can be expressed as the following product of commuting exponential terms.

\begin{equation*}
    U^q_p (\theta) =
    \left( \text{exp} \left[
    i \frac{\theta}{2} Y_p X_q \prod_{k=p+1}^{q-1} Z_k \right] \right)
    \left( \text{exp} \left[ -
    i \frac{\theta}{2} X_p Y_q \prod_{k=p+1}^{q-1} Z_k \right] \right)
\end{equation*}

Each exponential terms can be implemented by a quantum circuit consisting of a CNOT ladder construction conjugated by a Clifford subcircuit. By sequentially composing these circuits (\ref{composition}), that is taking their matrix product, we obtain the following quantum circuit implementing the one-body excitation operator.

% \includezxdiagramtext{chapter-5/one_body1}{0.45}{
% \left( \text{exp} \left[
% i \frac{\theta}{2} Y_p X_q
% \prod_{k=p+1}^{q-1} Z_k \right] \right)}

% And the second exponential term, as the following quantum circuit.

% \includezxdiagramtext{chapter-5/one_body2}{0.45}{
% \left( \text{exp} \left[ -
% i \frac{\theta}{2} X_p Y_q
% \prod_{k=p+1}^{q-1} Z_k \right] \right)}

% By sequentially composing these circuits, that is, taking their matrix product, we have implemented the one-body excitation operator acting on qubits $p$ and $q$.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-5/one_body4}{0.8}
    \caption{Circuit implementation of a one-body excitation operator.}
    \label{one-body-implementation}
\end{figure}

The CNOT ladder constructions compute the parity of the spin orbitals between $p$ and $q$, ensuring that the correct phase is applied to the fermionic state, thus accounting for the fermionic antisymmetry imposed by the Pauli principle.

Similarly, the two-body excitation operator can be factorised into eight commuting exponential terms, and implemented by composing eight subcircuits. Note that, for convenience, we have truncated the full circuit in the figure below.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-5/full_two_body}{1}
    \caption{Truncated circuit implementation of a two-body excitation operator.}
    \label{two-body-implementation}
\end{figure}

\subsection{Excitation Operators as Pauli Gadgets}%
\label{excitation-operators-pauli-gadgets}

Using the phase gadget result (\ref{phase-gadget-result}) to collapse the CNOT ladder constructions, we can show that the quantum circuit implementing a one-body excitation operator (Figure \ref{one-body-implementation}) corresponds to two commuting Pauli gadgets in the ZX calculus.

\includezxdiagram{chapter-5/one_body3}{0.45}

% Although essential for accurately simulating fermionic systems, these CNOT ladder constructions are extremely resource-intensive and contribute significantly to the circuit depth. Consequently, we are interested in optimising these excitation operators with respect to circuit depth.

Similarly, we can show that the quantum circuit implementing a two-body excitation operator (Figure \ref{two-body-implementation}) corresponds to eight commuting Pauli gadgets.

\includezxdiagram{chapter-5/two_body1}{1}

Recalling that Pauli gadgets can be decomposed using the balanced tree decomposition result (\ref{balanced-tree}), we obtain a circuit depth of $2\text{log}_2(n)$ rather than $2(n-1)$.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-5/balanced_tree}{0.65}
    \caption{Balanced tree decomposition of a one-body excitation operator.}
\end{figure}

Another advantage of representing the one-body and two-body excitation operators in this form is that we can easily show that the Pauli gadgets commute by recognising that each pair of gadgets has two mismatching pairs of legs (see Section \ref{commutation-relations}).

% The DISCO-VQE algorithm generates multiple UPS ansätze, each yielding the same energy expectation value, but corresponding to a unique sequence of excitation operators. The identical energy expectation values of these UPS ansätze implies that they equivalently capture the correlation present in the molecular system of interest, suggesting that it may be possible to demonstrate an equivalence between them through algebraic manipulation. Motivated by this result, in this section we use the commutation rules developed in Section \ref{commutation-relations} to identify which excitation operators in the DISCO-VQE operator pool commute, and which do not.

We define \textit{trivially commuting} excitation operators as commuting operators that act on a disjoint set of qubits, and \textit{non-trivially commuting} excitation operators as commuting operators which act on an intersecting set of qubits. By expressing the excitation operators in the DISCO-VQE operator pool in terms of Pauli gadgets, we were able to identify several previously unknown non-trivially commuting pairs of excitation operators. We hope that by using these commutation relations, we might be able to demonstrate an equivalence between the UPS ansätze generated by the DISCO-VQE algorithm. Whilst we did not have sufficient time to attempt this, we leave it to future researchers to attempt. In the following graph, A -- F represent one-body excitation operators and G -- L represent two-body excitation operators. We have then drawn lines between commuting pairs.

