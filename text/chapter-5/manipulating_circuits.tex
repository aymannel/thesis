\section{Manipulating Circuits}

The \lstinline{GadgetCircuit} class comes equipped with the \lstinline{apply()} method that allows us to insert a quantum gate, and its Hermitian conjugate, into the circuit. This operation preserves the matrix corresponding to a given cricuit. The method takes the quantum gate to apply as its first parameter, whilst the \lstinline{start} and \lstinline{end} parameters designate the insertion positions.

\includejupyter{chapter-5/apply1}{chapter-5/apply1_zx}{0.4}

If no specific positions are specified, the insertion defaults to placing one quantum gate at the start, and its Hermitian conjugate at the end, of the circuit. The \lstinline{GadgetCircuit} class then manages the relevant commutation relations, ensuring the expected gadget outcome. Hence, we below, we observe the gadget that results upon pushing a CNOT gate through the \lstinline{Gadget("YZ", phase=1/2)} object.

\includejupyter{chapter-5/apply2}{chapter-5/apply2_zx}{0.4}

We could have chosen any Pauli gadget by simply instantiating the relevant \lstinline{Gadget()} object. Alternatively, we could have chosen to insert any Hermitian conjugate pair of gates. The commutation logic implements Stim's \lstinline{Tableau} class to identify the behaviour of a Pauli string with a given Clifford or Pauli gate.

\includejupyter{chapter-5/apply_cz}{chapter-5/apply_cz_zx}{0.45}

The \lstinline{GadgetCircuit} class offers the ability to manipulate circuits containing multiple gadgets simultaneously. In the example below, we instantiate a single excitation operator as a \lstinline{GadgetCircuit} object.

\includejupyter{chapter-5/single1}{chapter-5/single1_zx}{0.49}

Conjugating the circuit with CNOTs reveals Pauli gadgets that represent a controlled rotation in the $Y$ basis. We have therefore demonstrated using ZxFermion the result outlined in Yordanov \textit{et al} \cite{Yordanov2020}.

\includejupyter{chapter-5/single2}{chapter-5/single2_zx}{0.63}

Although ZxFermion may seem simple at first glance, it comprises over four thousand lines of code. We consider it a significant achievement that with just a few lines of code, a user can now faithfully replicate derivations that took us many hours.
