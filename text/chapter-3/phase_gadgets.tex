\section{Phase Gadgets}
Phase gadgets are defined as the one parameter unitary groups of Pauli strings consisting of only the Pauli $I$ and $Z$ matrices, $P \in \{I, Z\}^{\otimes n}$. They can be naively implemented as a $Z$ rotation sandwiched between two ladders of CNOT gates.

\includezxdiagramtext{chapter-3/phase_gadget_expanded}{0.28}
{\text{exp} \left( - i \frac{\theta}{2} Z \otimes Z \otimes Z \right)}

Phase gadgets correspond to unitary maps which are diagonal in the $Z$ computational basis \cite{Cowtan2020}. Consequently, they apply a global phase to a state without changing the distribution of the observed state \cite{Yeung2020}. Phase gadgets have the following representation in the ZX calculus.

\includezxdiagramtext{chapter-3/phase_gadget}{0.15}{
\text{exp} \left( - i \frac{\theta}{2} Z \otimes Z \otimes Z \right)
= \begin{pmatrix}
    1 & \dots & 0 \\
    \vdots & \ddots & \vdots \\
    0 & \dots & e^{i\theta}
\end{pmatrix}}

Using the identity (\ref{identity}), spider fusion (\ref{spider-fusion}) and bialgebra (\ref{bialgebra}) rules, we are able to derive its representation in the ZX calculus.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-3/phase_gadget_proof}{0.75}
    \caption{Phase gadget result.}
    \label{phase-gadget-result}
\end{figure}

It is then a simple matter of recursively applying this result to phase gadgets in quantum circuit notation to generalise to arbitrary arity.

\includezxdiagram{chapter-3/phase_gadget_proof2}{0.8}%

Phase gadgets can be interpreted as first copying each input in the $Z$ basis (\ref{copy}), computing the parity of the state by taking the XOR (\ref{xor}), then multiplying the state by $\text{exp} \left(-i\frac{\theta}{2} \right)$ or $\text{exp} \left(i\frac{\theta}{2} \right)$ depending on its parity \cite{Yeung2020}. 

\includezxdiagramtext{chapter-3/phase_gadget_interpretation}{0.2}{
\text{diag} \left\{
\begin{pmatrix}
    1 \\ e^{i\theta} \\ e^{i\theta} \\ 1 \\
    e^{i\theta} \\ 1 \\ 1 \\ e^{i\theta}
\end{pmatrix} \cdot e^{-i\frac{\theta}{2}}
\right\}
}

%%%

\subsubsection{Phase Gadget Identity}%

We can show that phase gadgets with an angle $\theta = 0$ are equivalent to identity using the state copy (\ref{state-copy}), spider fusion (\ref{spider-fusion}) and identity removal (\ref{identity}) rules.

\includezxdiagram{chapter-3/phase_gadget_identity}{0.8}

%%%

\subsubsection{Phase Gadget Fusion}%
\label{phase-gadget-fusion}
Using the spider fusion (\ref{spider-fusion}) and bialgebra (\ref{bialgebra}) rules, we can show that phase gadgets with the same distribution of legs fuse together and their phases add.

% \includezxdiagram{chapter-3/phase_gadget_fusion}{0.55}
\includezxdiagram{chapter-3/phase_gadget_fusion_steps}{0.8}

%%%

\subsubsection{Phase Gadget Commutation}%
\label{phase-gadget-commutation}

Phase gadgets can be shown to commute using the spider fusion rule (\ref{spider-fusion}).

\includezxdiagram{chapter-3/phase_gadget_commutation}{0.6}

%%%

\subsubsection{Phase Gadget Decomposition}%

Using the bialgebra rule (\ref{bialgebra}), we can show that a two-legged phase gadget can be decomposed in the following two ways.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-3/phase_gadget_decomposition1}{0.6}
    \caption{Phase gadget decomposition result.}
    \label{phase-gadget-decomposition}
\end{figure}

% \subsubsection{Balanced Tree Decomposition}%
By recursively applying this decomposition, we can show that it is possible to decompose a phase gadget in the balanced tree representation such that it has a circuit depth of $2\log_2(n)$, rather than $2(n-1)$ in the ladder representation \cite{Cowtan2019}, where $n$ is the number of qubits.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-3/phase_gadget_decomposition}{0.95}
    \caption{Balanced tree phase gadget decomposition.}
    \label{balanced-tree}
\end{figure}

\subsubsection{Single-Legged Phase Gadgets}
Single-legged phase gadgets simply correspond to $Z$ rotations. Therefore, phase gadgets can be thought of as the many-qubit generalisation of $Z$ rotations.

\begin{figure}[H]
    \centering
    \includezxdiagram{chapter-3/phase_gadget_single_leg_steps}{0.5}
    \caption{Single-legged phase gadget as a $Z$ rotation.}
    \label{phase-gadget-single-leg}
\end{figure}

